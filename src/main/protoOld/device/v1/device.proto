syntax = "proto3";

package retail.devices.v1;

import "google/protobuf/timestamp.proto";
import "user/v1/user.proto";

option java_multiple_files = true;
option java_package = "com.apptorise.retail.admin.protos.v1";
option java_outer_classname = "DeviceProto";

service DeviceService {
  rpc ListMyDevices (ListMyDevicesRequest) returns (ListDevicesResponse);
  rpc ListAllDevices (ListAllDevicesRequest) returns (ListDevicesResponse);
  rpc GetDevice (GetDeviceRequest) returns (DeviceDetailResponse);
  rpc DeleteDevice (DeleteDeviceRequest) returns (DeleteDeviceResponse);
}

message DeviceSummary {
  int64 id = 1;
  string fingerprint = 2;
  string model = 3;
  string manufacturer = 4;
  string platform = 5;
  float battery_level = 6;
  google.protobuf.Timestamp last_seen_at = 7;
}

message Device {
  int64 id = 1;
  DeviceSummary summary = 2;
  string os_version = 3;
  retail.users.v1.UserSummary owner = 4;
  retail.users.v1.UserSummary current_user = 5;
  google.protobuf.Timestamp created_at = 6;
  repeated string active_tokens = 7;
}

message ListMyDevicesRequest {}

message ListAllDevicesRequest {
  int32 page_size = 1;
  string page_token = 2;
  string search_query = 3;
}

message ListDevicesResponse {
  repeated DeviceSummary devices = 1;
  string next_page_token = 2;
}

message GetDeviceRequest {
  int64 id = 1;
}

message DeviceDetailResponse {
  Device device = 1;
}

message DeleteDeviceRequest {
  int64 id = 1;
}

message DeleteDeviceResponse {
  bool success = 1;
}